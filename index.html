<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>For Reka</title>

<style>
  body{
    margin:0;
    padding:0;
    background:#fbe4ec;
    font-family:"Georgia", serif;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
  }

  /* Intro overlay */
  .intro{
    position:fixed;
    inset:0;
    background:rgba(251,228,236,0.96);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9999;
    padding:24px;
  }
  .intro-card{
    background:white;
    width:min(560px, 100%);
    border-radius:18px;
    box-shadow:0 20px 50px rgba(0,0,0,0.18);
    padding:34px 28px;
    text-align:center;
    animation: popIn 0.5s ease-out;
  }
  @keyframes popIn{
    from{ transform:translateY(12px); opacity:0; }
    to{ transform:translateY(0); opacity:1; }
  }
  .intro-title{
    font-size:22px;
    margin:0 0 10px;
    font-weight:normal;
  }
  .intro-sub{
    margin:0 0 18px;
    color:#444;
    font-family:Arial, sans-serif;
    line-height:1.5;
    font-size:14px;
  }
  .start-btn{
    border:none;
    border-radius:999px;
    padding:12px 18px;
    background:#ff4d88;
    color:white;
    cursor:pointer;
    font-family:Arial, sans-serif;
    font-size:14px;
  }
  .tiny{
    margin-top:12px;
    color:#777;
    font-family:Arial, sans-serif;
    font-size:12px;
  }

  /* Letter card */
  .letter{
    background:white;
    padding:46px;
    max-width:700px;
    width:calc(100% - 40px);
    border-radius:16px;
    box-shadow:0 20px 40px rgba(0,0,0,0.15);
    position:relative;
    z-index:2;
    opacity:0;
    transform:translateY(10px);
    transition:opacity .6s ease, transform .6s ease;
  }
  .letter.show{
    opacity:1;
    transform:translateY(0);
  }

  h1{
    margin:0 0 18px;
    font-weight:normal;
  }

  #typed{
    line-height:1.85;
    font-size:18px;
    color:#333;
    white-space:pre-wrap;
  }
  .cursor{
    display:inline-block;
    width:10px;
    margin-left:2px;
    animation:blink .9s infinite;
    color:#333;
    vertical-align:bottom;
  }
  @keyframes blink{
    0%,49%{opacity:1;}
    50%,100%{opacity:0;}
  }

  /* Apple embed container fades in AFTER typing */
  .music-wrap{
    margin-top:22px;
    opacity:0;
    transform:translateY(8px);
    transition:opacity .9s ease, transform .9s ease;
    display:none; /* hidden until end */
  }
  .music-wrap.show{
    display:block;
    opacity:1;
    transform:translateY(0);
  }

  /* Final glow message */
  .glow{
    margin-top:18px;
    display:none;
    text-align:center;
    font-family:Arial, sans-serif;
    font-size:18px;
    color:#ff2f7a;
    letter-spacing:0.3px;
  }
  .glow.show{
    display:block;
    animation: glowPulse 2.4s ease-in-out infinite;
    text-shadow:
      0 0 8px rgba(255,77,136,.35),
      0 0 18px rgba(255,77,136,.28),
      0 0 28px rgba(255,77,136,.18);
  }
  @keyframes glowPulse{
    0%,100%{ transform:scale(1); opacity:0.92; }
    50%{ transform:scale(1.03); opacity:1; }
  }

  /* Buttons */
  .btn-row{
    margin-top:18px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:space-between;
    align-items:center;
  }
  .btn{
    border:none;
    border-radius:999px;
    padding:10px 16px;
    cursor:pointer;
    font-family:Arial, sans-serif;
    font-size:14px;
  }
  .btn-reopen{
    background:#ff4d88;
    color:white;
    display:none; /* show at end */
  }
  .hint{
    font-family:Arial, sans-serif;
    font-size:12px;
    color:#666;
  }

  /* Floating hearts (subtle) */
  .heart{
    position:fixed;
    bottom:-40px;
    font-size:16px;
    opacity:0.28;
    z-index:1;
    animation:floatUp linear forwards;
    pointer-events:none;
    user-select:none;
  }
  @keyframes floatUp{
    0%   { transform: translateX(0) translateY(0) scale(1); opacity:0; }
    10%  { opacity:0.28; }
    100% { transform: translateX(var(--drift)) translateY(-110vh) scale(var(--scale)); opacity:0; }
  }
</style>
</head>

<body>

<!-- Tap to begin overlay -->
<div class="intro" id="intro">
  <div class="intro-card">
    <h2 class="intro-title">For Reka üíó</h2>
    <p class="intro-sub">
      I made something for you.<br>
      Tap the button to begin.
    </p>
    <button class="start-btn" id="startBtn">Tap to begin ‚ú®</button>
    <div class="tiny">Tip: the song appears after the letter finishes.</div>
  </div>
</div>

<!-- Letter -->
<div class="letter" id="letter">
  <h1>To Reka Tamas,</h1>

  <div>
    <span id="typed"></span><span class="cursor" id="cursor">|</span>
  </div>

  <!-- Apple Music Embed (fades in after typing) -->
  <div class="music-wrap" id="musicWrap">
    <iframe allow="autoplay *; encrypted-media *; fullscreen *; clipboard-write"
      frameborder="0"
      height="100"
      style="width:100%;max-width:660px;overflow:hidden;border-radius:10px;"
      sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
      src="https://embed.music.apple.com/hu/song/love-nwantiti-acoustic-version/1588970571">
    </iframe>
  </div>

  <!-- Final glow -->
  <div class="glow" id="glowText">I love you, Reka. ‚ù§Ô∏è</div>

  <div class="btn-row">
    <span class="hint" id="hint">Reading...</span>
    <button class="btn btn-reopen" id="reopenBtn">Open again whenever you need a reminder</button>
  </div>
</div>

<script>
  // ---------------------------
  // Text + typing effect
  // ---------------------------
  const letterText = `I don‚Äôt always say everything I feel out loud,
but I want you to know how much you mean to me.

Being with you feels easy, natural, and real.
You bring warmth into my life in ways you probably don‚Äôt even realize.

I love your strength, your kindness, your laugh,
and the way you make ordinary moments feel special.

I‚Äôm grateful that I get to call you mine ‚Äî
not just on Valentine‚Äôs Day, but every day.

Szeretlek, Reka.
Mindig t√©ged v√°lasztan√°lak.

Yours, always.
‚Äì Japheth`;

  const typedEl = document.getElementById("typed");
  const cursorEl = document.getElementById("cursor");
  const hintEl = document.getElementById("hint");
  const musicWrap = document.getElementById("musicWrap");
  const glowText = document.getElementById("glowText");
  const reopenBtn = document.getElementById("reopenBtn");
  const letterCard = document.getElementById("letter");

  let i = 0;
  let timer = null;
  const baseSpeed = 22;
  const punctuationPause = 220;

  function nextDelay(ch){
    if (ch === "\n") return 85;
    if (".,!?‚Äî".includes(ch)) return punctuationPause;
    return baseSpeed;
  }

  function type(){
    if (i < letterText.length){
      const ch = letterText[i];
      typedEl.textContent += ch;
      i++;
      timer = setTimeout(type, nextDelay(ch));
    } else {
      finishSequence();
    }
  }

  function finishSequence(){
    hintEl.textContent = "Done üíó";
    cursorEl.style.opacity = 0.25;

    // fade-in the Apple player
    musicWrap.classList.add("show");

    // glow message
    glowText.classList.add("show");

    // show reopen button
    reopenBtn.style.display = "inline-block";
  }

  function restartTyping(){
    clearTimeout(timer);
    i = 0;
    typedEl.textContent = "";
    hintEl.textContent = "Reading...";
    cursorEl.style.opacity = 1;

    // hide end elements
    musicWrap.classList.remove("show");
    glowText.classList.remove("show");
    reopenBtn.style.display = "none";

    // scroll up nicely
    window.scrollTo({ top: 0, behavior: "smooth" });

    type();
  }

  reopenBtn.addEventListener("click", restartTyping);

  // ---------------------------
  // Floating hearts (subtle)
  // ---------------------------
  const hearts = ["‚ù§","üíó","üíñ","üíï"];
  function spawnHeart(){
    const h = document.createElement("div");
    h.className = "heart";
    h.textContent = hearts[Math.floor(Math.random()*hearts.length)];

    const left = Math.random() * 100; // vw
    const drift = (Math.random() * 60 - 30) + "px"; // -30..30
    const duration = (Math.random() * 4 + 7); // 7..11s
    const scale = (Math.random() * 0.45 + 0.85).toFixed(2); // 0.85..1.3

    h.style.left = left + "vw";
    h.style.setProperty("--drift", drift);
    h.style.setProperty("--scale", scale);
    h.style.animationDuration = duration + "s";

    document.body.appendChild(h);
    setTimeout(()=>h.remove(), duration*1000 + 600);
  }
  let heartInterval = null;

  // ---------------------------
  // Tap to begin
  // ---------------------------
  const intro = document.getElementById("intro");
  const startBtn = document.getElementById("startBtn");

  function startExperience(){
    intro.style.display = "none";
    letterCard.classList.add("show");

    // start hearts
    if (!heartInterval) heartInterval = setInterval(spawnHeart, 750);

    // start typing
    type();
  }

  startBtn.addEventListener("click", startExperience);
</script>

</body>
</html>
